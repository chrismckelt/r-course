<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="//www.lendingclub.com/favicon.ico">
    <title>Coursera Data Science Capstone | Chris McKelt</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="font-awesome/css/font-awesome.css" rel="stylesheet">
    <link href="css/animate.css" rel="stylesheet">
    <link href="css/plugins/codemirror/codemirror.css" rel="stylesheet">
    <link href="css/plugins/codemirror/ambiance.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="css/shiny.css" rel="stylesheet" />
    <link href="css/animate.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/css-social-buttons/1.3.0/css/zocial.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/css-social-buttons/1.3.0/css/zocial.min.css.map" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/css-social-buttons/1.3.0/css/zocial.svg" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/css-social-buttons/1.3.0/css/zocial.ttf" rel="stylesheet">

    <!--shiny -->
    {{ headContent() }}
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <script src="js/bootstrap.min.js"></script>
    <script src="js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="js/plugins/slimscroll/jquery.slimscroll.min.js"></script>


    <!-- theme and plugin javascript -->
    <script src="js/favicon.min.js"></script>
    <script src="js/inspinia.js"></script>
    <script src="js/plugins/pace/pace.min.js"></script>
    <script src="js/plugins/select2/select2.full.min.js"></script>
    {{ useShinyjs() }}

    <script>
        predictedWords = [""];

        $(document).ready(function() {

            // https://simple.wikipedia.org/wiki/Most_common_words_in_English
            var mostCommonWords = [
                "the",
                "be",
                "to",
                "of",
                "and"
            ];

            function split(val) {
                return val.split(/,\s*/);
            }

            function extractLast(term) {
                return split(term).pop();
            }

            $("#search")
                .on("keydown", function(event) {
                    if (event.keyCode === $.ui.keyCode.TAB &&
                        $(this).autocomplete("instance").menu.active) {
                        event.preventDefault();
                    }
                })
                .autocomplete({
                    minLength: 0,
                    source: function(request, response) {
                        if (request.term.endsWith(' ')) {
                            remoteAllElements();
                            $("#search_button").click();
                            $("#predictions").show();
                            response($.ui.autocomplete.filter(predictedWords, extractLast(request.term)));
                        } else if (request.term === '') {
                            response($.ui.autocomplete.filter(mostCommonWords, extractLast(request.term)));
                        } else {
                            response($.ui.autocomplete.filter(predictedWords, extractLast(request.term)));
                        }
                    },
                    focus: function() {
                        // prevent value inserted on focus
                        return false;
                    },
                    select: function(event, ui) {
                        var terms = split(this.value);
                        // remove the current input
                        terms.pop();
                        // add the selected item
                        terms.push(ui.item.value);
                        // add placeholder to get the comma-and-space at the end
                        terms.push("");
                        this.value = terms.join(" ");
                        return false;
                    }
                });

            // This recieves messages of type "testmessage" from the server.
            // See http://shiny.rstudio.com/gallery/server-to-client-custom-messages.html
            // for details
            Shiny.addCustomMessageHandler("pred_1",
                function(message) {
                    result = JSON.stringify(message)
                    console.log(result);
                    createElement(result);
                    predictedWords.push(result);
                }
            );

            Shiny.addCustomMessageHandler("pred_2",
                function(message) {
                    result = JSON.stringify(message)
                    createElement(result);
                }
            );

            Shiny.addCustomMessageHandler("pred_3",
                function(message) {
                    result = JSON.stringify(message)
                    createElement(result);
                }
            );

            ul = $('#prediction_results');

            function createElement(word) {
                console.log(word);
                if (word == 'null') return;
                if ($.inArray(word, predictedWords)) {
                    predictedWords.push(word);
                    ul.append($('<li>' + word + '</li>'));
                }

                predictedWords = predictedWords.filter(onlyUnique);
            }

            function remoteAllElements() {
                ul.empty();
                predictedWords = [];
            }

            function onlyUnique(value, index, self) {
                return self.indexOf(value) === index;
            }


        });
    </script>

</head>

<body>

    <div id="wrapper">

        <nav class="navbar-default navbar-static-side" role="navigation">
            <div class="sidebar-collapse">
                <ul class="nav metismenu" id="side-menu">
                    <li class="nav-header">
                        <div class="dropdown profile-element">
                            <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                                <span class="clear">
                                    <span class="block m-t-xs">
                                        <strong class="font-bold">Chris McKelt</strong>
                                    </span> <span class="text-muted text-xs block">@chris_mckelt<b class="caret"></b></span>
                                </span>
                            </a>
                            <ul class="dropdown-menu animated fadeInRight m-t-xs">
                                <li>
                                    <a href="https://github.com/chrismckelt/r-course/tree/master/10-capstone">View code</a>
                                </li>
                            </ul>
                        </div>
                        <div class="logo-element">
                            <span class="glyphicon glyphicon-star" aria-hidden="true"></span>
                        </div>
                    </li>
                    <li>
                        <li class="active" href="#" onclick="javascript: showDiv(1);">
                            <a href="#">
                                <i class="fa fa-th-large"></i> <span class="nav-label">1. Prediction</span>
                            </a>
                        </li>
                        <li onclick="javascript: showDiv(2);">
                            <a href="#">
                                <i class="fa fa-th-large"></i> <span class="nav-label">2. Documentation</span>
                            </a>
                        </li>
                        <li class="#" onclick="javascript: showDiv(3);">
                            <a href="#">
                                <i class="fa fa-th-large"></i> <span class="nav-label">3. Contact</span>
                            </a>
                        </li>
                        <li class="#">
                            <a href="https://chrismckelt.github.io/r-course/10-capstone/" target="_new">
                                <i class="fa fa-th-large"></i> <span class="nav-label">Report</span>
                            </a>
                        </li>
                </ul>
            </div>
        </nav>

        <div id="page-wrapper" class="gray-bg">

            <div class="row border-bottom">
                <nav class="navbar navbar-static-top white-bg" role="navigation" style="margin-bottom: 0">
                    <div class="navbar-header">
                        <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="#">
                            <i class="fa fa-bars">&nbsp;&nbsp;&nbsp;&nbsp;Text prediction through Natural Language Processing</i>
                        </a>
                    </div>
                </nav>
            </div>

            <div id="div1" class="wrapper wrapper-content animated fadeInRight">
                <div class="col-lg-12">
                    <div class="text-centre m-t-lg">
                        <h1> Start typing below to activate a prediction of the next word.</h1>
                        <hr/>
                        <p>The next word will be predicted</p>
                        <form role="form">
                            <div class="row">
                                <div class="form-group">
                                    <label for="search">Search</label>
                                    <input id="search" type="text" class="form-control input-lg">
                                </div>
                            </div>

                            <div class="row">
                                <button id="search_button" type="submit" class="btn btn-default" style="display:none;">Search</button>
                            </div>
                            <div id="predictions" class="row">
                                <h4>predictions</h4>
                                <ul id="prediction_results">
                                </ul>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <div id="div2" class="wrapper wrapper-content animated fadeInRight">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="text-left m-t-lg">
                            <h1>
                                Overview
                            </h1>
                            <hr/>
                        </div>
                    </div>
                </div>
            </div>

            <div id="div3" class="wrapper wrapper-content animated fadeInRight">
                <div class="col-xs-12">
                    <h1>
                        Contact the author
                    </h1>
                    <hr/>
                    <ul class="list" style="list-style-type: none;">
                        <li>
                            <a href="http://www.linkedin.com/in/chrismckelt" class="zocial linkedin">linkedin</a>
                        </li>
                        <li>&nbsp;</li>
                        <li>
                            <a href="http://twitter.com/chris_mckelt" class="zocial email">chris@mckelt.com</a>
                        </li>
                        <li>&nbsp;</li>
                        <li>
                            <a href="http://twitter.com/chris_mckelt" class="zocial twitter">@chris_mckelt</a>
                        </li>
                        <li>&nbsp;</li>
                        <li>
                            <a href="https://github.com/chrismckelt" class="zocial github">chrismckelt</a>
                        </li>
                        <li>&nbsp;</li>
                        <li>
                            <a href="http://mckelt.com/blog" class="zocial blogger">Blog</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

    </div>
    {{actionLink("stop", "stop")}}
    <script src="js/custom.js"></script>
</body>

</html>